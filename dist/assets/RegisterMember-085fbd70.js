import{b as q,u as B,r as x,j as e,W as n,Z as M,T as l,J as s,bA as b,B as T,bB as R,bC as D}from"./index-9d3b7c60.js";import{u as L,m as j,D as P}from"./city.loader-0d95a1c5.js";import{u as V}from"./useMutation-88ed882c.js";import{S as O}from"./Sidebar-34927406.js";import{R as u,g as G}from"./branch.service-277ce805.js";import{F as t,R as a}from"./validator-f348bde3.js";import{r as K}from"./render-61154ab5.js";import{S as N}from"./index-4435f3e4.js";import{I as d}from"./index-3b646168.js";import"./InfoCircleFilled-2bc4e92d.js";import"./useQuery-a5d9a860.js";import"./utils-0507c293.js";const U=async o=>{var c;return(await((c=q)==null?void 0:c.post("customers/create",o))).data},X=({config:o})=>V({onMutate:()=>{},onError:()=>{},onSuccess:()=>{},...o,mutationFn:U}),A="_container_1bltc_1",J="_list-item_1bltc_4",W="_label_1bltc_8",Z="_footer-form_1bltc_16",r={container:A,"list-item":"_list-item_1bltc_4",listItem:J,label:W,"footer-form":"_footer-form_1bltc_16",footerForm:Z};function ie(){const{t:o}=B(),[h]=t.useForm(),[c,_]=x.useState(),I=K(o),[y,C]=x.useState([]),[S,p]=x.useState(!1),{data:w,isLoading:v}=L({}),g=X({config:{onSuccess:i=>{if(!i.results){j.error(i.message);return}j.success("Đăng ký thành công!")},onError:()=>{j.error("Có lỗi xảy ra! Vui lòng thử lại")}}}),k=()=>{h.validateFields().then(i=>{g.mutate({...i,birthday:R(c).format(D)})})},F=async i=>{h.setFieldValue("branch_id",""),p(!0);const m=await G({city_id:i});m.message||C(m),p(!1)},E=()=>e.jsxs("div",{className:r.container,children:[e.jsx(n.Title,{level:3,children:"Đăng ký tham gia thành viên KINESS"}),e.jsx(M,{}),e.jsxs(t,{form:h,className:r.content,children:[e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Trung tâm Kiness"," ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(t.Item,{name:"city_id",rules:[...a.required],children:e.jsx(N,{loading:v,onSelect:F,options:w||[],placeholder:"Chọn tỉnh, thành phố"})})}),e.jsx(s,{span:12,children:e.jsx(t.Item,{name:"branch_id",rules:[...a.required],children:e.jsx(N,{placeholder:"Chọn chi nhánh",loading:S,options:y||[]})})})]}),e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Tên tài khoản ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(t.Item,{name:"customer_id",rules:[...a.required,...a.username],children:e.jsx(d,{placeholder:"Tên tài khoản"})})}),e.jsx(s,{span:12,children:e.jsx(n.Text,{type:"secondary",children:"(Tối đa 6-8 chữ/số)"})})]}),e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Mật khẩu ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(t.Item,{name:"password",rules:[...a.required,...a.password],children:e.jsx(d.Password,{placeholder:"Mật khẩu"})})})]}),e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Xác nhận mật khẩu"," ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(t.Item,{name:"confirm-password",rules:[...a.required,({getFieldValue:i})=>({validator(m,f){return!f||i("password")===f?Promise.resolve():Promise.reject(new Error("Mật khẩu phải trùng nhau "))}})],children:e.jsx(d.Password,{placeholder:" Xác nhận mật khẩu"})})})]}),e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Tên thành viên"," ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(t.Item,{name:"customer_name",rules:[...a.required],children:e.jsx(d,{placeholder:"Tên thành viên"})})})]}),e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsx(n.Text,{className:r.label,children:"Ngày sinh"})}),e.jsx(s,{span:6,children:e.jsx(t.Item,{children:e.jsx(P,{style:{width:"100%"},onChange:i=>_(i),value:c!=null&&c.isValid()?c:void 0,format:b,placeholder:b.toLowerCase()})})})]}),e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsx(n.Text,{className:r.label,children:"Giới tính"})}),e.jsx(s,{span:6,children:e.jsx(t.Item,{name:"gender",initialValue:1,children:e.jsxs(u.Group,{defaultValue:1,children:[e.jsx(u,{value:1,children:"Nam"}),e.jsx(u,{value:0,children:"Nữ"})]})})})]}),e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsx(n.Text,{className:r.label,children:"Địa chỉ"})}),e.jsx(s,{span:18,children:e.jsx(t.Item,{name:"address",children:e.jsx(d,{placeholder:"Địa chỉ"})})})]}),e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Số điện thoại ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(t.Item,{name:"phone_number",rules:[...a.required,...a.phone],children:e.jsx(d,{placeholder:"Số điện thoại"})})})]}),e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Email ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(t.Item,{name:"email",rules:[...a.required,...a.email],children:e.jsx(d,{placeholder:"Email"})})})]}),e.jsx(l,{className:r.footerForm,children:e.jsxs(s,{span:24,children:[e.jsx(T,{children:o("all.btn_cancel")}),e.jsx(T,{className:"filled",htmlType:"submit",onClick:k,loading:g.isLoading,children:o("all.btn_confirm")})]})})]})]});return e.jsx(O,{children:E(),items:I})}export{ie as default};
