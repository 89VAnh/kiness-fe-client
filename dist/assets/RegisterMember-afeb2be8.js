import{O as R,V as q,r as x,Q as e,X as M,T as n,Y as B,L as i,A as s,bC as N,bD as j,b9 as O,bE as P,B as T,bF as V}from"./index-9a78810f.js";import{u as G,m as u,D as U}from"./city.loader-8bb278bc.js";import{u as X}from"./useMutation-302e202b.js";import{R as p,g as K}from"./branch.service-53284dc8.js";import{F as a,R as l}from"./validator-ab66ccab.js";import{r as A}from"./render-41cc0740.js";import{S as _}from"./index-7c45ffbc.js";import{I as d}from"./index-16334ca6.js";import"./InfoCircleFilled-caf22935.js";import"./useQuery-e8d2bc3e.js";import"./utils-0507c293.js";const Q=async o=>{var c;return(await((c=R)==null?void 0:c.post("customers/create",o))).data},Y=({config:o})=>X({onMutate:()=>{},onError:()=>{},onSuccess:()=>{},...o,mutationFn:Q}),z="_container_1bltc_1",H="_list-item_1bltc_4",J="_label_1bltc_8",W="_footer-form_1bltc_16",r={container:z,"list-item":"_list-item_1bltc_4",listItem:H,label:J,"footer-form":"_footer-form_1bltc_16",footerForm:W};function oe(){const{t:o}=q(),[h]=a.useForm(),[c,I]=x.useState(),y=A(o),[C,w]=x.useState([]),[S,g]=x.useState(!1),{data:k,isLoading:v}=G({}),f=Y({config:{onSuccess:t=>{if(!t.results){u.error(t.message);return}u.success("Đăng ký thành công!"),h.resetFields()},onError:t=>{u.error(t.message)}}}),F=()=>{h.validateFields().then(t=>{f.mutate({...t,birthday:j(c).format(V)})})},L=async t=>{h.setFieldValue("branch_id",""),g(!0);const m=await K({city_id:t});m.message||w(m),g(!1)},E=t=>t&&t>j().endOf("day"),D=()=>e.jsxs("div",{className:r.container,children:[e.jsx(n.Title,{level:3,children:"Đăng ký tham gia thành viên KINESS"}),e.jsx(B,{}),e.jsxs(a,{form:h,className:r.content,children:[e.jsxs(i,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Trung tâm Kiness"," ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(a.Item,{name:"city_id",rules:[...l.required],children:e.jsx(_,{loading:v,onSelect:L,options:k||[],placeholder:"Chọn tỉnh, thành phố"})})}),e.jsx(s,{span:12,children:e.jsx(a.Item,{name:"branch_id",rules:[...l.required],children:e.jsx(_,{placeholder:"Chọn chi nhánh",loading:S,options:C||[]})})})]}),e.jsxs(i,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Tên tài khoản ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(a.Item,{name:"customer_id",rules:[...l.required,...l.username],children:e.jsx(d,{placeholder:"Tên tài khoản"})})}),e.jsx(s,{span:12,children:e.jsx(n.Text,{type:"secondary",children:"(Tối đa 6-8 chữ/số)"})})]}),e.jsxs(i,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Mật khẩu ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(a.Item,{name:"password",rules:[...l.required,...l.password],children:e.jsx(d.Password,{placeholder:"Mật khẩu"})})})]}),e.jsxs(i,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Xác nhận mật khẩu"," ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(a.Item,{name:"confirm-password",rules:[...l.required,({getFieldValue:t})=>({validator(m,b){return!b||t("password")===b?Promise.resolve():Promise.reject(new Error("Mật khẩu phải trùng nhau "))}})],children:e.jsx(d.Password,{placeholder:" Xác nhận mật khẩu"})})})]}),e.jsxs(i,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Tên thành viên"," ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(a.Item,{name:"customer_name",rules:[...l.required],children:e.jsx(d,{placeholder:"Tên thành viên"})})})]}),e.jsxs(i,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsx(n.Text,{className:r.label,children:"Ngày sinh"})}),e.jsx(s,{span:6,children:e.jsx(a.Item,{children:e.jsx(U,{style:{width:"100%"},onChange:t=>I(t),value:c!=null&&c.isValid()?c:void 0,format:N,placeholder:N.toLowerCase(),disabledDate:E,defaultValue:j("1999-01-01")})})})]}),e.jsxs(i,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsx(n.Text,{className:r.label,children:"Giới tính"})}),e.jsx(s,{span:6,children:e.jsx(a.Item,{name:"gender",initialValue:1,children:e.jsxs(p.Group,{defaultValue:1,children:[e.jsx(p,{value:1,children:"Nam"}),e.jsx(p,{value:0,children:"Nữ"})]})})})]}),e.jsxs(i,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsx(n.Text,{className:r.label,children:"Địa chỉ"})}),e.jsx(s,{span:18,children:e.jsx(a.Item,{name:"address",children:e.jsx(d,{placeholder:"Địa chỉ"})})})]}),e.jsxs(i,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Số điện thoại ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(a.Item,{name:"phone_number",rules:[...l.required,...l.phone],children:e.jsx(d,{placeholder:"Số điện thoại"})})})]}),e.jsxs(i,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Email ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(a.Item,{name:"email",rules:[...l.required,...l.email],children:e.jsx(d,{placeholder:"Email"})})})]}),e.jsx(i,{className:r.footerForm,children:e.jsxs(s,{span:24,children:[e.jsx(O,{to:P,children:e.jsx(T,{children:o("all.btn_cancel")})}),e.jsx(T,{className:"filled",htmlType:"submit",onClick:F,loading:f.isLoading,children:o("all.btn_confirm")})]})})]})]});return e.jsx(M,{children:D(),items:y})}export{oe as default};
