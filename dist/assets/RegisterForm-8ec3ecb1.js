import{O as q,r as h,bR as N,bS as v,V as O,Q as e,T as s,L as x,A as a,bT as B,bC as _,B as T,b9 as M,bU as U,bD as C,bF as P}from"./index-b1f5c75a.js";import{b as V,F as n,R as t}from"./validator-90de51cf.js";import{d as G}from"./TextArea-24ceaad7.js";import{u as H,D as A,m as w}from"./city.loader-d861d207.js";import{u as K}from"./useMutation-0d47789b.js";import{R as m,g as Q}from"./branch.service-86cbabec.js";import{S as u}from"./index-24839470.js";import{I as j}from"./index-3fe60932.js";import"./InfoCircleFilled-1fd03163.js";import"./useQuery-1a333170.js";import"./utils-0507c293.js";const $="experience-register",z=async i=>{var c;return(await((c=q)==null?void 0:c.post(`${$}/create`,i))).data},J=({config:i})=>K({onMutate:()=>{},onError:()=>{},onSuccess:()=>{},...i,mutationFn:z}),W="_form_1n5i5_1",X="_row_1n5i5_18",Y="_label_1n5i5_22",Z="_input_1n5i5_31",ee="_btns_1n5i5_35",o={form:W,row:X,label:Y,input:Z,btns:ee};function he(){const[i,g]=h.useState([]),[c,y]=h.useState(!1),[l,I]=h.useState(),R=N(v),[b]=V(),{data:S,isLoading:k}=H({}),{t:d}=O(),D=r=>r&&r<=C().endOf("day").add(-1,"day"),E=J({config:{onSuccess:()=>{w.success(d("messages.register_success"))},onError:r=>{w.error(r.message)}}}),F=async r=>{y(!0);const f=await Q({city_id:r});f.message||g(f),y(!1)},p=[{key:"branch_id",label:e.jsxs(s.Text,{children:["Trung tâm Kiness ",e.jsx(s.Text,{type:"danger",children:"*"})]}),input:e.jsxs(x,{gutter:24,children:[e.jsx(a,{span:7,children:e.jsx(n.Item,{name:"city_id",rules:[...t.required],children:e.jsx(u,{loading:k,placeholder:"Chọn tỉnh, thành phố",style:{width:"100%"},onChange:F,options:S||[]})})}),e.jsx(a,{span:13,children:e.jsx(n.Item,{name:"branch_id",rules:[...t.required],children:e.jsx(u,{loading:c,placeholder:"Chọn chi nhánh",style:{width:"100%"},options:i||[]})})})]})},{key:"fullname",label:e.jsxs(s.Text,{children:["Tên người đăng ký ",e.jsx(s.Text,{type:"danger",children:"*"})]}),input:e.jsx(a,{span:7,children:e.jsx(n.Item,{name:"fullname",rules:[...t.required,...t.people_name],children:e.jsx(j,{placeholder:"Họ và tên"})})})},{key:"gender",label:e.jsxs(s.Text,{children:["Giới tính ",e.jsx(s.Text,{type:"danger",children:"*"})]}),input:e.jsx(a,{children:e.jsx(n.Item,{name:"gender",rules:[...t.required],initialValue:"0",children:e.jsxs(m.Group,{children:[e.jsx(m,{value:"0",children:" Nam "}),e.jsx(m,{value:"1",children:" Nữ "})]})})})},{key:"level",label:e.jsxs(s.Text,{children:["Cấp ",e.jsx(s.Text,{type:"danger",children:"*"})]}),input:e.jsx(n.Item,{name:"level",wrapperCol:{span:20},rules:[...t.required],children:e.jsx(u,{placeholder:"Chọn",options:B})})},{key:"date",label:e.jsxs(s.Text,{children:["Ngày đặt trải nghiệm"," ",e.jsx(s.Text,{type:"danger",children:"*"})]}),input:e.jsx(n.Item,{name:"date",wrapperCol:{span:7},rules:[...t.required],children:e.jsx(A,{onChange:r=>I(r),value:l!=null&&l.isValid()?l:void 0,format:_,placeholder:_.toLowerCase(),name:"date",disabledDate:D})})},{key:"phone_number",label:e.jsxs(s.Text,{children:["Số điện thoại ",e.jsx(s.Text,{type:"danger",children:"*"})]}),input:e.jsx(n.Item,{name:"phone_number",wrapperCol:{span:7},rules:[...t.required,...t.phone],children:e.jsx(j,{placeholder:"Số điện thoại"})})},{key:"address",label:e.jsxs(s.Text,{children:["Địa chỉ ",e.jsx(s.Text,{type:"danger",children:"*"})]}),input:e.jsx(n.Item,{name:"address",wrapperCol:{span:20},rules:[...t.required],children:e.jsx(j,{placeholder:"Địa chỉ"})})},{key:"detail",label:e.jsx(s.Text,{children:"Chi tiết"}),input:e.jsx(n.Item,{name:"detail",wrapperCol:{span:20},children:e.jsx(G,{rows:5,placeholder:"Chi tiết"})})}],L=r=>{E.mutate({...r,date:C(l).format(P),created_by_user_id:R.user_id||1}),b.resetFields()};return e.jsxs(n,{className:o.form,form:b,onFinish:L,children:[p==null?void 0:p.map(r=>e.jsxs(x,{className:o.row,children:[e.jsx(a,{className:o.label,style:{width:200},children:r.label}),e.jsx(a,{flex:"auto",className:o.input,children:r.input})]},r.key)),e.jsxs(x,{gutter:24,className:o.btns,children:[e.jsx(a,{offset:12,children:e.jsx(n.Item,{children:e.jsx(T,{type:"default",htmlType:"reset",children:e.jsx(M,{to:U,children:d("all.btn_cancel")})})})}),e.jsx(a,{children:e.jsx(n.Item,{children:e.jsx(T,{type:"primary",htmlType:"submit",children:d("all.btn_register")})})})]})]})}export{he as default};
