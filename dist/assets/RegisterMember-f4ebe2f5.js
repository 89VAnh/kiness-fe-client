import{O as R,V as q,r as x,Q as e,T as n,X as B,L as i,A as s,bA as N,bB as j,b7 as M,bC as O,B as T,bD as P}from"./index-df8a925b.js";import{u as V,m as u,D as G}from"./city.loader-ae693f1d.js";import{u as U}from"./useMutation-ed0df2f5.js";import{S as X}from"./Sidebar-5ae3b7e8.js";import{R as p,g as A}from"./branch.service-5e785910.js";import{F as a,R as l}from"./validator-ca8f8c1a.js";import{r as K}from"./render-560d1ab0.js";import{S as _}from"./index-4f588ac5.js";import{I as d}from"./index-7a8e23cc.js";import"./InfoCircleFilled-50b51dd0.js";import"./useQuery-85ac9809.js";import"./utils-0507c293.js";const Q=async o=>{var c;return(await((c=R)==null?void 0:c.post("customers/create",o))).data},z=({config:o})=>U({onMutate:()=>{},onError:()=>{},onSuccess:()=>{},...o,mutationFn:Q}),H="_container_1bltc_1",J="_list-item_1bltc_4",W="_label_1bltc_8",Y="_footer-form_1bltc_16",r={container:H,"list-item":"_list-item_1bltc_4",listItem:J,label:W,"footer-form":"_footer-form_1bltc_16",footerForm:Y};function de(){const{t:o}=q(),[h]=a.useForm(),[c,I]=x.useState(),y=K(o),[C,S]=x.useState([]),[w,g]=x.useState(!1),{data:k,isLoading:v}=V({}),f=z({config:{onSuccess:t=>{if(!t.results){u.error(t.message);return}u.success("Đăng ký thành công!"),h.resetFields()},onError:t=>{u.error(t.message)}}}),F=()=>{h.validateFields().then(t=>{f.mutate({...t,birthday:j(c).format(P)})})},L=async t=>{h.setFieldValue("branch_id",""),g(!0);const m=await A({city_id:t});m.message||S(m),g(!1)},D=t=>t&&t>j().endOf("day"),E=()=>e.jsxs("div",{className:r.container,children:[e.jsx(n.Title,{level:3,children:"Đăng ký tham gia thành viên KINESS"}),e.jsx(B,{}),e.jsxs(a,{form:h,className:r.content,children:[e.jsxs(i,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Trung tâm Kiness"," ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(a.Item,{name:"city_id",rules:[...l.required],children:e.jsx(_,{loading:v,onSelect:L,options:k||[],placeholder:"Chọn tỉnh, thành phố"})})}),e.jsx(s,{span:12,children:e.jsx(a.Item,{name:"branch_id",rules:[...l.required],children:e.jsx(_,{placeholder:"Chọn chi nhánh",loading:w,options:C||[]})})})]}),e.jsxs(i,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Tên tài khoản ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(a.Item,{name:"customer_id",rules:[...l.required,...l.username],children:e.jsx(d,{placeholder:"Tên tài khoản"})})}),e.jsx(s,{span:12,children:e.jsx(n.Text,{type:"secondary",children:"(Tối đa 6-8 chữ/số)"})})]}),e.jsxs(i,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Mật khẩu ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(a.Item,{name:"password",rules:[...l.required,...l.password],children:e.jsx(d.Password,{placeholder:"Mật khẩu"})})})]}),e.jsxs(i,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Xác nhận mật khẩu"," ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(a.Item,{name:"confirm-password",rules:[...l.required,({getFieldValue:t})=>({validator(m,b){return!b||t("password")===b?Promise.resolve():Promise.reject(new Error("Mật khẩu phải trùng nhau "))}})],children:e.jsx(d.Password,{placeholder:" Xác nhận mật khẩu"})})})]}),e.jsxs(i,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Tên thành viên"," ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(a.Item,{name:"customer_name",rules:[...l.required],children:e.jsx(d,{placeholder:"Tên thành viên"})})})]}),e.jsxs(i,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsx(n.Text,{className:r.label,children:"Ngày sinh"})}),e.jsx(s,{span:6,children:e.jsx(a.Item,{children:e.jsx(G,{style:{width:"100%"},onChange:t=>I(t),value:c!=null&&c.isValid()?c:void 0,format:N,placeholder:N.toLowerCase(),disabledDate:D,defaultValue:j("1999-01-01")})})})]}),e.jsxs(i,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsx(n.Text,{className:r.label,children:"Giới tính"})}),e.jsx(s,{span:6,children:e.jsx(a.Item,{name:"gender",initialValue:1,children:e.jsxs(p.Group,{defaultValue:1,children:[e.jsx(p,{value:1,children:"Nam"}),e.jsx(p,{value:0,children:"Nữ"})]})})})]}),e.jsxs(i,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsx(n.Text,{className:r.label,children:"Địa chỉ"})}),e.jsx(s,{span:18,children:e.jsx(a.Item,{name:"address",children:e.jsx(d,{placeholder:"Địa chỉ"})})})]}),e.jsxs(i,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Số điện thoại ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(a.Item,{name:"phone_number",rules:[...l.required,...l.phone],children:e.jsx(d,{placeholder:"Số điện thoại"})})})]}),e.jsxs(i,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Email ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(a.Item,{name:"email",rules:[...l.required,...l.email],children:e.jsx(d,{placeholder:"Email"})})})]}),e.jsx(i,{className:r.footerForm,children:e.jsxs(s,{span:24,children:[e.jsx(M,{to:O,children:e.jsx(T,{children:o("all.btn_cancel")})}),e.jsx(T,{className:"filled",htmlType:"submit",onClick:F,loading:f.isLoading,children:o("all.btn_confirm")})]})})]})]});return e.jsx(X,{children:E(),items:y})}export{de as default};
