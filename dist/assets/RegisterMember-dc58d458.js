import{X as q,u as D,r as x,j as e,S as M,Z as n,a1 as R,U as l,K as s,bD as b,B as N,bE as B,bF as L}from"./index-fd25e44e.js";import{u as P,m as j,D as V}from"./city.loader-15fb0803.js";import{u as O}from"./useMutation-7e44e8c0.js";import{R as u,g as K}from"./branch.service-f38614b9.js";import{F as t,R as a}from"./validator-830f2534.js";import{r as U}from"./render-d0fd54ef.js";import{S as T}from"./index-4bafcd5c.js";import{I as d}from"./index-390e4d02.js";import"./InfoCircleFilled-bfc572df.js";const X=async o=>{var c;return(await((c=q)==null?void 0:c.post("customers/create",o))).data},G=({config:o})=>O({onMutate:()=>{},onError:()=>{},onSuccess:()=>{},...o,mutationFn:X}),Z="_container_1bltc_1",z="_list-item_1bltc_4",A="_label_1bltc_8",H="_footer-form_1bltc_16",r={container:Z,"list-item":"_list-item_1bltc_4",listItem:z,label:A,"footer-form":"_footer-form_1bltc_16",footerForm:H};function te(){const{t:o}=D(),[h]=t.useForm(),[c,_]=x.useState(),I=U(o),[y,C]=x.useState([]),[S,p]=x.useState(!1),{data:w,isLoading:v}=P({}),g=G({config:{onSuccess:i=>{if(!i.results){j.error(i.message);return}j.success("Đăng ký thành công!")},onError:()=>{j.error("Có lỗi xảy ra! Vui lòng thử lại")}}}),k=()=>{h.validateFields().then(i=>{g.mutate({...i,birthday:B(c).format(L)})})},F=async i=>{h.setFieldValue("branch_id",""),p(!0);const m=await K({city_id:i});m.message||C(m),p(!1)},E=()=>e.jsxs("div",{className:r.container,children:[e.jsx(n.Title,{level:3,children:"Đăng ký tham gia thành viên KINESS"}),e.jsx(R,{}),e.jsxs(t,{form:h,className:r.content,children:[e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Trung tâm Kiness"," ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(t.Item,{name:"city_id",rules:[...a.required],children:e.jsx(T,{loading:v,onSelect:F,options:w||[],placeholder:"Chọn tỉnh, thành phố"})})}),e.jsx(s,{span:12,children:e.jsx(t.Item,{name:"branch_id",rules:[...a.required],children:e.jsx(T,{placeholder:"Chọn chi nhánh",loading:S,options:y||[]})})})]}),e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Tên tài khoản ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(t.Item,{name:"customer_id",rules:[...a.required,...a.username],children:e.jsx(d,{placeholder:"Tên tài khoản"})})}),e.jsx(s,{span:12,children:e.jsx(n.Text,{type:"secondary",children:"(Tối đa 6-8 chữ/số)"})})]}),e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Mật khẩu ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(t.Item,{name:"password",rules:[...a.required,...a.password],children:e.jsx(d.Password,{placeholder:"Mật khẩu"})})})]}),e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Xác nhận mật khẩu"," ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(t.Item,{name:"confirm-password",rules:[...a.required,({getFieldValue:i})=>({validator(m,f){return!f||i("password")===f?Promise.resolve():Promise.reject(new Error("Mật khẩu phải trùng nhau "))}})],children:e.jsx(d.Password,{placeholder:" Xác nhận mật khẩu"})})})]}),e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Tên thành viên"," ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(t.Item,{name:"customer_name",rules:[...a.required],children:e.jsx(d,{placeholder:"Tên thành viên"})})})]}),e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsx(n.Text,{className:r.label,children:"Ngày sinh"})}),e.jsx(s,{span:6,children:e.jsx(t.Item,{children:e.jsx(V,{style:{width:"100%"},onChange:i=>_(i),value:c!=null&&c.isValid()?c:void 0,format:b,placeholder:b.toLowerCase()})})})]}),e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsx(n.Text,{className:r.label,children:"Giới tính"})}),e.jsx(s,{span:6,children:e.jsx(t.Item,{name:"gender",initialValue:1,children:e.jsxs(u.Group,{defaultValue:1,children:[e.jsx(u,{value:1,children:"Nam"}),e.jsx(u,{value:0,children:"Nữ"})]})})})]}),e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsx(n.Text,{className:r.label,children:"Địa chỉ"})}),e.jsx(s,{span:18,children:e.jsx(t.Item,{name:"address",children:e.jsx(d,{placeholder:"Địa chỉ"})})})]}),e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Số điện thoại ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(t.Item,{name:"phone_number",rules:[...a.required,...a.phone],children:e.jsx(d,{placeholder:"Số điện thoại"})})})]}),e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Email ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(t.Item,{name:"email",rules:[...a.required,...a.email],children:e.jsx(d,{placeholder:"Email"})})})]}),e.jsx(l,{className:r.footerForm,children:e.jsxs(s,{span:24,children:[e.jsx(N,{children:o("all.btn_cancel")}),e.jsx(N,{className:"filled",htmlType:"submit",onClick:k,loading:g.isLoading,children:o("all.btn_confirm")})]})})]})]});return e.jsx(M,{children:E(),items:I})}export{te as default};
