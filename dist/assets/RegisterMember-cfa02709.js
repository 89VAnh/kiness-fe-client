import{U as q,u as M,r as x,j as e,T as n,X as R,O as l,G as s,by as b,B as T,bz as B,bA as D}from"./index-6b48638c.js";import{u as L,m as j,D as P}from"./city.loader-9afe0def.js";import{u as O}from"./useMutation-572536ce.js";import{S as V}from"./Sidebar-6c2a4edb.js";import{R as u,g as G}from"./branch.service-9cb7ecf9.js";import{F as t,R as a}from"./validator-fedbdd2f.js";import{r as U}from"./render-b55aaf05.js";import{S as N}from"./useQuery-86d40cbd.js";import{I as d}from"./utils-669b16e7.js";import"./InfoCircleFilled-a8831a87.js";const X=async o=>{var c;return(await((c=q)==null?void 0:c.post("customers/create",o))).data},K=({config:o})=>O({onMutate:()=>{},onError:()=>{},onSuccess:()=>{},...o,mutationFn:X}),z="_container_1bltc_1",A="_list-item_1bltc_4",H="_label_1bltc_8",J="_footer-form_1bltc_16",r={container:z,"list-item":"_list-item_1bltc_4",listItem:A,label:H,"footer-form":"_footer-form_1bltc_16",footerForm:J};function ae(){const{t:o}=M(),[h]=t.useForm(),[c,_]=x.useState(),I=U(o),[y,C]=x.useState([]),[S,p]=x.useState(!1),{data:w,isLoading:v}=L({}),g=K({config:{onSuccess:i=>{if(!i.results){j.error(i.message);return}j.success("Đăng ký thành công!")},onError:()=>{j.error("Có lỗi xảy ra! Vui lòng thử lại")}}}),k=()=>{h.validateFields().then(i=>{g.mutate({...i,birthday:B(c).format(D)})})},F=async i=>{h.setFieldValue("branch_id",""),p(!0);const m=await G({city_id:i});m.message||C(m),p(!1)},E=()=>e.jsxs("div",{className:r.container,children:[e.jsx(n.Title,{level:3,children:"Đăng ký tham gia thành viên KINESS"}),e.jsx(R,{}),e.jsxs(t,{form:h,className:r.content,children:[e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Trung tâm Kiness"," ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(t.Item,{name:"city_id",rules:[...a.required],children:e.jsx(N,{loading:v,onSelect:F,options:w||[],placeholder:"Chọn tỉnh, thành phố"})})}),e.jsx(s,{span:12,children:e.jsx(t.Item,{name:"branch_id",rules:[...a.required],children:e.jsx(N,{placeholder:"Chọn chi nhánh",loading:S,options:y||[]})})})]}),e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Tên tài khoản ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(t.Item,{name:"customer_id",rules:[...a.required,...a.username],children:e.jsx(d,{placeholder:"Tên tài khoản"})})}),e.jsx(s,{span:12,children:e.jsx(n.Text,{type:"secondary",children:"(Tối đa 6-8 chữ/số)"})})]}),e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Mật khẩu ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(t.Item,{name:"password",rules:[...a.required,...a.password],children:e.jsx(d.Password,{placeholder:"Mật khẩu"})})})]}),e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Xác nhận mật khẩu"," ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(t.Item,{name:"confirm-password",rules:[...a.required,({getFieldValue:i})=>({validator(m,f){return!f||i("password")===f?Promise.resolve():Promise.reject(new Error("Mật khẩu phải trùng nhau "))}})],children:e.jsx(d.Password,{placeholder:" Xác nhận mật khẩu"})})})]}),e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Tên thành viên"," ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(t.Item,{name:"customer_name",rules:[...a.required],children:e.jsx(d,{placeholder:"Tên thành viên"})})})]}),e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsx(n.Text,{className:r.label,children:"Ngày sinh"})}),e.jsx(s,{span:6,children:e.jsx(t.Item,{children:e.jsx(P,{style:{width:"100%"},onChange:i=>_(i),value:c!=null&&c.isValid()?c:void 0,format:b,placeholder:b.toLowerCase()})})})]}),e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsx(n.Text,{className:r.label,children:"Giới tính"})}),e.jsx(s,{span:6,children:e.jsx(t.Item,{name:"gender",initialValue:1,children:e.jsxs(u.Group,{defaultValue:1,children:[e.jsx(u,{value:1,children:"Nam"}),e.jsx(u,{value:0,children:"Nữ"})]})})})]}),e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsx(n.Text,{className:r.label,children:"Địa chỉ"})}),e.jsx(s,{span:18,children:e.jsx(t.Item,{name:"address",children:e.jsx(d,{placeholder:"Địa chỉ"})})})]}),e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Số điện thoại ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(t.Item,{name:"phone_number",rules:[...a.required,...a.phone],children:e.jsx(d,{placeholder:"Số điện thoại"})})})]}),e.jsxs(l,{gutter:24,className:r.listItem,children:[e.jsx(s,{span:6,children:e.jsxs(n.Text,{className:r.label,children:["Email ",e.jsx(n.Text,{type:"danger",children:"*"})]})}),e.jsx(s,{span:6,children:e.jsx(t.Item,{name:"email",rules:[...a.required,...a.email],children:e.jsx(d,{placeholder:"Email"})})})]}),e.jsx(l,{className:r.footerForm,children:e.jsxs(s,{span:24,children:[e.jsx(T,{children:o("all.btn_cancel")}),e.jsx(T,{className:"filled",htmlType:"submit",onClick:k,loading:g.isLoading,children:o("all.btn_confirm")})]})})]})]});return e.jsx(V,{children:E(),items:I})}export{ae as default};
